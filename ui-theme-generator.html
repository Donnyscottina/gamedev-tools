<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UI Theme Generator Pro</title>
    <link href="style.css" rel="stylesheet">
    <style>
        .tool-container { display: grid; grid-template-columns: 400px 1fr; gap: 25px; margin-top: 20px; }
        @media (max-width: 1200px) { .tool-container { grid-template-columns: 1fr; } }
        
        .controls-panel { background: var(--panel); padding: 25px; border-radius: 12px; border: 1px solid var(--border); max-height: 90vh; overflow-y: auto; }
        .color-input-group { margin-bottom: 20px; }
        .color-input-group label { display: block; margin-bottom: 10px; font-weight: 600; font-size: 14px; }
        .color-picker-wrapper { display: flex; gap: 12px; align-items: center; }
        .color-picker { width: 70px; height: 70px; border: 3px solid var(--border); border-radius: 10px; cursor: pointer; transition: all 0.2s; }
        .color-picker:hover { transform: scale(1.05); border-color: var(--accent); }
        .hex-input { flex: 1; padding: 12px; border: 2px solid var(--border); background: var(--bg); color: var(--text); border-radius: 8px; font-family: 'Courier New', monospace; font-size: 15px; font-weight: 600; }
        
        .quick-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 20px; }
        .quick-btn { padding: 10px; background: var(--panel); border: 2px solid var(--border); color: var(--text); border-radius: 6px; cursor: pointer; font-size: 12px; text-align: center; transition: all 0.2s; }
        .quick-btn:hover { border-color: var(--accent); background: var(--highlight); }
        
        .scheme-selector { margin-bottom: 20px; }
        .scheme-selector h4 { margin-bottom: 12px; font-size: 13px; color: #888; text-transform: uppercase; letter-spacing: 0.5px; }
        .scheme-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }
        .scheme-btn { padding: 12px 8px; background: var(--panel); border: 2px solid var(--border); color: var(--text); border-radius: 6px; cursor: pointer; transition: all 0.2s; font-size: 11px; text-align: center; }
        .scheme-btn:hover { border-color: var(--accent); background: rgba(0,122,204,0.05); }
        .scheme-btn.active { background: var(--accent); color: #000; border-color: var(--accent); font-weight: bold; }
        
        .mode-selector { display: flex; gap: 10px; margin-bottom: 20px; }
        .mode-btn { flex: 1; padding: 14px; background: var(--panel); border: 2px solid var(--border); color: var(--text); border-radius: 8px; cursor: pointer; transition: all 0.2s; font-weight: 600; }
        .mode-btn:hover { border-color: var(--accent); }
        .mode-btn.active { background: var(--accent); color: #000; border-color: var(--accent); }
        
        .palette-section { margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--border); }
        .palette-section h4 { margin-bottom: 12px; font-size: 12px; color: #888; text-transform: uppercase; }
        .color-row { display: flex; gap: 10px; margin-bottom: 8px; align-items: center; padding: 6px; border-radius: 6px; transition: background 0.2s; }
        .color-row:hover { background: rgba(0,122,204,0.03); }
        .color-swatch { width: 45px; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid rgba(255,255,255,0.1); box-shadow: 0 2px 6px rgba(0,0,0,0.15); transition: all 0.2s; position: relative; }
        .color-swatch:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.25); }
        .color-info { flex: 1; }
        .color-label { font-size: 12px; font-weight: 600; margin-bottom: 2px; }
        .color-meta { display: flex; gap: 6px; align-items: center; flex-wrap: wrap; }
        .color-value { font-family: 'Courier New', monospace; font-size: 10px; color: #888; cursor: pointer; padding: 2px 5px; background: rgba(0,122,204,0.05); border-radius: 3px; }
        .color-value:hover { color: var(--accent); background: rgba(0,122,204,0.1); }
        .contrast-badge { font-size: 9px; padding: 2px 5px; border-radius: 3px; font-weight: 600; }
        .contrast-aaa { background: #28a745; color: white; }
        .contrast-aa { background: #ffc107; color: #000; }
        .contrast-fail { background: #dc3545; color: white; }
        
        .preview-panel { background: var(--panel); padding: 25px; border-radius: 12px; border: 1px solid var(--border); }
        .preview-tabs { display: flex; gap: 8px; margin-bottom: 20px; }
        .preview-tab { padding: 10px 16px; background: var(--panel); border: 2px solid var(--border); border-radius: 6px; cursor: pointer; font-size: 12px; transition: all 0.2s; }
        .preview-tab:hover { border-color: var(--accent); }
        .preview-tab.active { background: var(--accent); color: #000; border-color: var(--accent); font-weight: bold; }
        .preview-mode { display: none; }
        .preview-mode.active { display: block; }
        
        .ui-preview { padding: 30px; border-radius: 12px; transition: all 0.3s; }
        .ui-nav { padding: 18px 24px; border-radius: 10px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .ui-nav-title { font-weight: 700; font-size: 18px; }
        .ui-nav-links { display: flex; gap: 20px; font-size: 14px; }
        .ui-content { padding: 25px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 1px 4px rgba(0,0,0,0.05); }
        .ui-heading { margin: 0 0 12px 0; font-size: 20px; font-weight: 700; }
        .ui-text { margin: 0 0 15px 0; line-height: 1.6; }
        .ui-buttons { display: flex; gap: 12px; flex-wrap: wrap; margin: 20px 0; }
        .ui-btn { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
        .ui-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 10px rgba(0,0,0,0.15); }
        .ui-alerts { display: grid; gap: 12px; margin: 20px 0; }
        .ui-alert { padding: 16px 20px; border-radius: 8px; border-left: 4px solid; font-size: 14px; display: flex; align-items: center; gap: 12px; }
        .ui-input { width: 100%; padding: 14px; border-radius: 8px; font-size: 14px; margin-top: 12px; border: 2px solid; }
        .ui-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .ui-card { padding: 20px; border-radius: 10px; border: 1px solid; transition: all 0.2s; }
        .ui-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        .game-preview { padding: 20px; }
        .game-hud { position: relative; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .health-bar { height: 30px; border-radius: 6px; overflow: hidden; border: 2px solid; position: relative; }
        .health-fill { height: 100%; transition: width 0.3s; }
        .game-menu { padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .menu-item { padding: 12px 20px; margin: 8px 0; border-radius: 6px; cursor: pointer; transition: all 0.2s; }
        .menu-item:hover { transform: translateX(5px); }
        
        .gradient-preview { height: 60px; border-radius: 8px; margin: 10px 0; }
        
        .export-section { margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--border); }
        .export-btn { width: 100%; padding: 14px; background: var(--accent); color: #000; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s; }
        .export-btn:hover { opacity: 0.9; transform: translateY(-1px); }
        .export-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; margin-top: 8px; }
        .export-option { padding: 8px; background: var(--panel); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; text-align: center; font-size: 11px; transition: all 0.2s; }
        .export-option:hover { border-color: var(--accent); background: var(--highlight); }
        
        .preset-section { margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--border); }
        .preset-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 10px; }
        .preset-item { padding: 10px; background: var(--panel); border: 2px solid var(--border); border-radius: 6px; cursor: pointer; text-align: center; font-size: 11px; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .preset-item:hover { border-color: var(--accent); }
        .preset-color { width: 20px; height: 20px; border-radius: 4px; border: 1px solid rgba(0,0,0,0.2); }
        
        #imageInput { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h2>üé® UI Theme Generator Pro</h2>
        <p style="color: #888; margin-bottom: 20px;">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ü–≤–µ—Ç–æ–≤—ã—Ö —Å—Ö–µ–º –¥–ª—è –≤–µ–±–∞ –∏ –∏–≥—Ä —Å —Ç–µ–æ—Ä–∏–µ–π —Ü–≤–µ—Ç–∞ –∏ WCAG –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å—é</p>
        
        <div class="tool-container">
            <div class="controls-panel">
                <div class="color-input-group">
                    <label>–ë–∞–∑–æ–≤—ã–π —Ü–≤–µ—Ç</label>
                    <div class="color-picker-wrapper">
                        <input type="color" id="primaryColor" class="color-picker" value="#007acc">
                        <input type="text" id="primaryHex" class="hex-input" value="#007ACC" maxlength="7">
                    </div>
                </div>
                
                <div class="quick-actions">
                    <button class="quick-btn" onclick="randomColor()">üé≤ –°–ª—É—á–∞–π–Ω—ã–π</button>
                    <button class="quick-btn" onclick="document.getElementById('imageInput').click()">üñºÔ∏è –ò–∑ —Ñ–æ—Ç–æ</button>
                    <button class="quick-btn" onclick="invertColor()">üîÑ –ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="quick-btn" onclick="lightenColor()">‚òÄÔ∏è –û—Å–≤–µ—Ç–ª–∏—Ç—å</button>
                </div>
                
                <input type="file" id="imageInput" accept="image/*" onchange="extractFromImage(event)">
                
                <div class="scheme-selector">
                    <h4>–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞</h4>
                    <div class="scheme-grid">
                        <button class="scheme-btn active" data-scheme="monochromatic">–ú–æ–Ω–æ—Ö—Ä–æ–º–Ω–∞—è</button>
                        <button class="scheme-btn" data-scheme="complementary">–ö–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä</button>
                        <button class="scheme-btn" data-scheme="analogous">–ê–Ω–∞–ª–æ–≥–æ–≤–∞—è</button>
                        <button class="scheme-btn" data-scheme="triadic">–¢—Ä–∏–∞–¥–Ω–∞—è</button>
                        <button class="scheme-btn" data-scheme="split">–°–ø–ª–∏—Ç</button>
                        <button class="scheme-btn" data-scheme="tetradic">–¢–µ—Ç—Ä–∞–¥–Ω–∞—è</button>
                    </div>
                </div>
                
                <div class="mode-selector">
                    <button class="mode-btn active" data-mode="light">‚òÄÔ∏è Light</button>
                    <button class="mode-btn" data-mode="dark">üåô Dark</button>
                </div>
                
                <div class="palette-section">
                    <h4>–û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞</h4>
                    <div id="primaryPalette"></div>
                    
                    <h4 style="margin-top: 15px;">–°–æ—Å—Ç–æ—è–Ω–∏—è</h4>
                    <div id="statesPalette"></div>
                    
                    <h4 style="margin-top: 15px;">–§–æ–Ω—ã</h4>
                    <div id="basePalette"></div>
                    
                    <h4 style="margin-top: 15px;">–°–µ–º–∞–Ω—Ç–∏–∫–∞</h4>
                    <div id="alertsPalette"></div>
                </div>
                
                <div class="preset-section">
                    <h4>–ü—Ä–µ—Å–µ—Ç—ã</h4>
                    <div class="quick-actions">
                        <button class="quick-btn" onclick="savePreset()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                        <button class="quick-btn" onclick="loadPresets()">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    </div>
                    <div class="preset-grid" id="presetList"></div>
                </div>
                
                <div class="export-section">
                    <button class="export-btn" onclick="exportPalette('css')">üìã –≠–∫—Å–ø–æ—Ä—Ç CSS</button>
                    <div class="export-grid">
                        <div class="export-option" onclick="exportPalette('scss')">SCSS</div>
                        <div class="export-option" onclick="exportPalette('json')">JSON</div>
                        <div class="export-option" onclick="exportPalette('tailwind')">Tailwind</div>
                        <div class="export-option" onclick="exportPalette('unity')">Unity</div>
                        <div class="export-option" onclick="exportPalette('godot')">Godot</div>
                        <div class="export-option" onclick="exportPalette('unreal')">Unreal</div>
                    </div>
                </div>
            </div>
            
            <div class="preview-panel">
                <div class="preview-tabs">
                    <button class="preview-tab active" data-preview="web">üåê Web UI</button>
                    <button class="preview-tab" data-preview="game">üéÆ Game UI</button>
                    <button class="preview-tab" data-preview="gradient">üåà –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã</button>
                </div>
                
                <div class="preview-mode active" id="webPreview"></div>
                <div class="preview-mode" id="gamePreview"></div>
                <div class="preview-mode" id="gradientPreview"></div>
            </div>
        </div>
    </div>
    
    <script src="global.js"></script>
    <script>
        let currentMode = 'light';
        let currentScheme = 'monochromatic';
        let currentPalette = {};
        let presets = JSON.parse(localStorage.getItem('colorPresets') || '[]');
        
        document.getElementById('primaryColor').addEventListener('input', e => {
            document.getElementById('primaryHex').value = e.target.value.toUpperCase();
            generateTheme(e.target.value);
        });
        
        document.getElementById('primaryHex').addEventListener('input', e => {
            const val = e.target.value.toUpperCase();
            if (/^#[0-9A-F]{6}$/i.test(val)) {
                document.getElementById('primaryColor').value = val;
                generateTheme(val);
            }
        });
        
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentMode = btn.dataset.mode;
                generateTheme(document.getElementById('primaryColor').value);
            });
        });
        
        document.querySelectorAll('.scheme-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.scheme-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentScheme = btn.dataset.scheme;
                generateTheme(document.getElementById('primaryColor').value);
            });
        });
        
        document.querySelectorAll('.preview-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.preview-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const previewType = tab.dataset.preview;
                document.querySelectorAll('.preview-mode').forEach(p => p.classList.remove('active'));
                document.getElementById(previewType + 'Preview').classList.add('active');
            });
        });
        
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }
        
        function rgbToHex(r, g, b) {
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase();
        }
        
        function hexToHsl(hex) {
            const rgb = hexToRgb(hex);
            const r = rgb.r / 255, g = rgb.g / 255, b = rgb.b / 255;
            const max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;
            
            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                    case g: h = ((b - r) / d + 2) / 6; break;
                    case b: h = ((r - g) / d + 4) / 6; break;
                }
            }
            return { h: h * 360, s: s * 100, l: l * 100 };
        }
        
        function hslToHex(h, s, l) {
            s /= 100; l /= 100;
            const c = (1 - Math.abs(2 * l - 1)) * s;
            const x = c * (1 - Math.abs((h / 60) % 2 - 1));
            const m = l - c / 2;
            let r = 0, g = 0, b = 0;
            
            if (0 <= h && h < 60) { r = c; g = x; b = 0; }
            else if (60 <= h && h < 120) { r = x; g = c; b = 0; }
            else if (120 <= h && h < 180) { r = 0; g = c; b = x; }
            else if (180 <= h && h < 240) { r = 0; g = x; b = c; }
            else if (240 <= h && h < 300) { r = x; g = 0; b = c; }
            else if (300 <= h && h < 360) { r = c; g = 0; b = x; }
            
            return rgbToHex(
                Math.round((r + m) * 255),
                Math.round((g + m) * 255),
                Math.round((b + m) * 255)
            );
        }
        
        function adjustLightness(hex, amount) {
            const hsl = hexToHsl(hex);
            hsl.l = Math.max(0, Math.min(100, hsl.l + amount));
            return hslToHex(hsl.h, hsl.s, hsl.l);
        }
        
        function adjustSaturation(hex, amount) {
            const hsl = hexToHsl(hex);
            hsl.s = Math.max(0, Math.min(100, hsl.s + amount));
            return hslToHex(hsl.h, hsl.s, hsl.l);
        }
        
        function rotateHue(hex, degrees) {
            const hsl = hexToHsl(hex);
            hsl.h = (hsl.h + degrees + 360) % 360;
            return hslToHex(hsl.h, hsl.s, hsl.l);
        }
        
        function getLuminance(hex) {
            const rgb = hexToRgb(hex);
            const [r, g, b] = [rgb.r, rgb.g, rgb.b].map(val => {
                val /= 255;
                return val <= 0.03928 ? val / 12.92 : Math.pow((val + 0.055) / 1.055, 2.4);
            });
            return 0.2126 * r + 0.7152 * g + 0.0722 * b;
        }
        
        function getContrastRatio(hex1, hex2) {
            const lum1 = getLuminance(hex1);
            const lum2 = getLuminance(hex2);
            const lighter = Math.max(lum1, lum2);
            const darker = Math.min(lum1, lum2);
            return (lighter + 0.05) / (darker + 0.05);
        }
        
        function getContrastLevel(ratio) {
            if (ratio >= 7) return 'AAA';
            if (ratio >= 4.5) return 'AA';
            return 'FAIL';
        }
        
        function getTextColor(bgHex, isLight) {
            const darkText = isLight ? '#1a1a1a' : '#e0e0e0';
            const lightText = isLight ? '#ffffff' : '#0a0a0a';
            const darkContrast = getContrastRatio(bgHex, darkText);
            const lightContrast = getContrastRatio(bgHex, lightText);
            return darkContrast > lightContrast ? darkText : lightText;
        }
        
        function randomColor() {
            const randomHex = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0').toUpperCase();
            document.getElementById('primaryColor').value = randomHex;
            document.getElementById('primaryHex').value = randomHex;
            generateTheme(randomHex);
        }
        
        function invertColor() {
            const current = document.getElementById('primaryColor').value;
            const rgb = hexToRgb(current);
            const inverted = rgbToHex(255 - rgb.r, 255 - rgb.g, 255 - rgb.b);
            document.getElementById('primaryColor').value = inverted;
            document.getElementById('primaryHex').value = inverted;
            generateTheme(inverted);
        }
        
        function lightenColor() {
            const current = document.getElementById('primaryColor').value;
            const lightened = adjustLightness(current, 15);
            document.getElementById('primaryColor').value = lightened;
            document.getElementById('primaryHex').value = lightened;
            generateTheme(lightened);
        }
        
        function extractFromImage(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = e => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img, 0, 0);
                    
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
                    const colorMap = {};
                    
                    for (let i = 0; i < imageData.length; i += 4) {
                        const r = imageData[i], g = imageData[i+1], b = imageData[i+2], a = imageData[i+3];
                        if (a < 128) continue;
                        const hex = rgbToHex(r, g, b);
                        colorMap[hex] = (colorMap[hex] || 0) + 1;
                    }
                    
                    const sortedColors = Object.entries(colorMap).sort((a, b) => b[1] - a[1]);
                    if (sortedColors.length > 0) {
                        const dominantColor = sortedColors[0][0];
                        document.getElementById('primaryColor').value = dominantColor;
                        document.getElementById('primaryHex').value = dominantColor;
                        generateTheme(dominantColor);
                    }
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        function savePreset() {
            const name = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ—Å–µ—Ç–∞:', `Preset ${presets.length + 1}`);
            if (!name) return;
            
            presets.push({
                name,
                color: document.getElementById('primaryColor').value,
                scheme: currentScheme,
                mode: currentMode
            });
            localStorage.setItem('colorPresets', JSON.stringify(presets));
            renderPresets();
        }
        
        function loadPresets() {
            renderPresets();
        }
        
        function renderPresets() {
            const list = document.getElementById('presetList');
            list.innerHTML = presets.map((p, i) => `
                <div class="preset-item" onclick="applyPreset(${i})">
                    <div class="preset-color" style="background: ${p.color}"></div>
                    <span>${p.name}</span>
                </div>
            `).join('');
        }
        
        function applyPreset(index) {
            const preset = presets[index];
            document.getElementById('primaryColor').value = preset.color;
            document.getElementById('primaryHex').value = preset.color;
            currentScheme = preset.scheme;
            currentMode = preset.mode;
            
            document.querySelectorAll('.scheme-btn').forEach(b => {
                b.classList.toggle('active', b.dataset.scheme === preset.scheme);
            });
            document.querySelectorAll('.mode-btn').forEach(b => {
                b.classList.toggle('active', b.dataset.mode === preset.mode);
            });
            
            generateTheme(preset.color);
        }
        
        function generateColorScheme(baseHex, scheme) {
            const hsl = hexToHsl(baseHex);
            const colors = [baseHex];
            
            switch(scheme) {
                case 'monochromatic':
                    colors.push(
                        adjustLightness(baseHex, 15),
                        adjustLightness(baseHex, -15),
                        adjustSaturation(baseHex, -20)
                    );
                    break;
                case 'complementary':
                    colors.push(rotateHue(baseHex, 180));
                    colors.push(adjustLightness(colors[0], 15));
                    colors.push(adjustLightness(colors[1], 15));
                    break;
                case 'analogous':
                    colors.push(
                        rotateHue(baseHex, 30),
                        rotateHue(baseHex, -30),
                        rotateHue(baseHex, 60)
                    );
                    break;
                case 'triadic':
                    colors.push(
                        rotateHue(baseHex, 120),
                        rotateHue(baseHex, 240)
                    );
                    colors.push(adjustLightness(colors[0], 10));
                    break;
                case 'split':
                    colors.push(
                        rotateHue(baseHex, 150),
                        rotateHue(baseHex, 210)
                    );
                    colors.push(adjustLightness(colors[0], 10));
                    break;
                case 'tetradic':
                    colors.push(
                        rotateHue(baseHex, 90),
                        rotateHue(baseHex, 180),
                        rotateHue(baseHex, 270)
                    );
                    break;
            }
            return colors;
        }
        
        function generateTheme(primaryColor) {
            const isLight = currentMode === 'light';
            const schemeColors = generateColorScheme(primaryColor, currentScheme);
            
            const primary = schemeColors[0];
            const primaryHover = adjustLightness(primary, isLight ? -10 : 10);
            const primaryActive = adjustLightness(primary, isLight ? -20 : 20);
            const primaryDisabled = adjustSaturation(adjustLightness(primary, isLight ? 30 : -30), -40);
            
            const secondary = schemeColors[1] || adjustLightness(primary, 20);
            const accent = schemeColors[2] || adjustSaturation(primary, 20);
            
            const background = isLight ? '#ffffff' : '#0f0f0f';
            const backgroundAlt = isLight ? '#f8f9fa' : '#1a1a1a';
            const surface = isLight ? '#ffffff' : '#242424';
            const border = isLight ? '#dee2e6' : '#3d3d3d';
            
            const textPrimary = isLight ? '#1a1a1a' : '#f0f0f0';
            const textSecondary = isLight ? '#495057' : '#b0b0b0';
            const textDisabled = isLight ? '#adb5bd' : '#606060';
            
            const success = '#28a745';
            const successBg = isLight ? '#d4edda' : '#1a3d24';
            const successText = getTextColor(successBg, isLight);
            
            const warning = '#ffc107';
            const warningBg = isLight ? '#fff3cd' : '#3d3420';
            const warningText = getTextColor(warningBg, isLight);
            
            const error = '#dc3545';
            const errorBg = isLight ? '#f8d7da' : '#3d1a1f';
            const errorText = getTextColor(errorBg, isLight);
            
            const info = '#17a2b8';
            const infoBg = isLight ? '#d1ecf1' : '#1a3639';
            const infoText = getTextColor(infoBg, isLight);
            
            currentPalette = {
                primary, primaryHover, primaryActive, primaryDisabled,
                secondary, accent,
                background, backgroundAlt, surface, border,
                textPrimary, textSecondary, textDisabled,
                success, successBg, successText,
                warning, warningBg, warningText,
                error, errorBg, errorText,
                info, infoBg, infoText
            };
            
            renderPalette();
            renderWebPreview();
            renderGamePreview();
            renderGradientPreview();
        }
        
        function renderPalette() {
            const p = currentPalette;
            
            document.getElementById('primaryPalette').innerHTML = `
                ${colorRow('Primary', p.primary, p.background)}
                ${colorRow('Secondary', p.secondary, p.background)}
                ${colorRow('Accent', p.accent, p.background)}
            `;
            
            document.getElementById('statesPalette').innerHTML = `
                ${colorRow('Hover', p.primaryHover, p.background)}
                ${colorRow('Active', p.primaryActive, p.background)}
                ${colorRow('Disabled', p.primaryDisabled, p.background)}
            `;
            
            document.getElementById('basePalette').innerHTML = `
                ${colorRow('Background', p.background, p.textPrimary)}
                ${colorRow('Surface', p.surface, p.textPrimary)}
                ${colorRow('Border', p.border, p.background)}
            `;
            
            document.getElementById('alertsPalette').innerHTML = `
                ${colorRow('Success', p.success, p.successBg)}
                ${colorRow('Warning', p.warning, p.warningBg)}
                ${colorRow('Error', p.error, p.errorBg)}
                ${colorRow('Info', p.info, p.infoBg)}
            `;
        }
        
        function colorRow(name, color, contrastWith) {
            const ratio = getContrastRatio(color, contrastWith).toFixed(2);
            const level = getContrastLevel(ratio);
            const badgeClass = level === 'AAA' ? 'contrast-aaa' : level === 'AA' ? 'contrast-aa' : 'contrast-fail';
            
            return `
                <div class="color-row">
                    <div class="color-swatch" style="background: ${color}" onclick="copyColor('${color}')"></div>
                    <div class="color-info">
                        <div class="color-label">${name}</div>
                        <div class="color-meta">
                            <div class="color-value" onclick="copyColor('${color}')">${color}</div>
                            <div class="contrast-badge ${badgeClass}">${ratio}:1</div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function copyColor(color) {
            navigator.clipboard.writeText(color);
        }
        
        function renderWebPreview() {
            const p = currentPalette;
            const primaryText = getTextColor(p.primary, currentMode === 'light');
            
            document.getElementById('webPreview').innerHTML = `
                <div class="ui-preview" style="background: ${p.background};">
                    <div class="ui-nav" style="background: ${p.primary}; color: ${primaryText};">
                        <div class="ui-nav-title">Application</div>
                        <div class="ui-nav-links">Home ‚Ä¢ Products ‚Ä¢ About</div>
                    </div>
                    
                    <div class="ui-content" style="background: ${p.surface}; color: ${p.textPrimary}; border: 1px solid ${p.border};">
                        <h4 class="ui-heading">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h4>
                        <p class="ui-text" style="color: ${p.textSecondary};">–û–ø–∏—Å–∞–Ω–∏–µ —Å –≤—Ç–æ—Ä–∏—á–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏.</p>
                        <input class="ui-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..." style="background: ${p.background}; color: ${p.textPrimary}; border-color: ${p.border};">
                    </div>
                    
                    <div class="ui-buttons">
                        <button class="ui-btn" style="background: ${p.primary}; color: ${primaryText};">Primary</button>
                        <button class="ui-btn" style="background: ${p.secondary}; color: ${getTextColor(p.secondary, currentMode === 'light')};">Secondary</button>
                        <button class="ui-btn" style="background: ${p.accent}; color: ${getTextColor(p.accent, currentMode === 'light')};">Accent</button>
                    </div>
                    
                    <div class="ui-alerts">
                        <div class="ui-alert" style="background: ${p.successBg}; color: ${p.successText}; border-left-color: ${p.success};">‚úì –£—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                        <div class="ui-alert" style="background: ${p.infoBg}; color: ${p.infoText}; border-left-color: ${p.info};">‚Ñπ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                        <div class="ui-alert" style="background: ${p.warningBg}; color: ${p.warningText}; border-left-color: ${p.warning};">‚ö† –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</div>
                        <div class="ui-alert" style="background: ${p.errorBg}; color: ${p.errorText}; border-left-color: ${p.error};">‚úï –û—à–∏–±–∫–∞</div>
                    </div>
                    
                    <div class="ui-cards">
                        <div class="ui-card" style="background: ${p.surface}; color: ${p.textPrimary}; border-color: ${p.border};">
                            <h5>Card 1</h5>
                            <p style="color: ${p.textSecondary}; font-size: 12px;">–ö–∞—Ä—Ç–æ—á–∫–∞ –Ω–∞ surface</p>
                        </div>
                        <div class="ui-card" style="background: ${p.backgroundAlt}; color: ${p.textPrimary}; border-color: ${p.border};">
                            <h5>Card 2</h5>
                            <p style="color: ${p.textSecondary}; font-size: 12px;">–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ñ–æ–Ω</p>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderGamePreview() {
            const p = currentPalette;
            
            document.getElementById('gamePreview').innerHTML = `
                <div class="game-preview" style="background: ${p.background}; color: ${p.textPrimary};">
                    <div class="game-hud" style="background: ${p.surface}; border: 2px solid ${p.border};">
                        <h4 style="margin: 0 0 10px 0;">Health Bar</h4>
                        <div class="health-bar" style="background: ${p.backgroundAlt}; border-color: ${p.border};">
                            <div class="health-fill" style="width: 75%; background: linear-gradient(90deg, ${p.success}, ${adjustLightness(p.success, 15)});"></div>
                        </div>
                    </div>
                    
                    <div class="game-menu" style="background: ${p.surface}; border: 2px solid ${p.border};">
                        <h4 style="margin: 0 0 15px 0;">Game Menu</h4>
                        <div class="menu-item" style="background: ${p.primary}; color: ${getTextColor(p.primary, currentMode === 'light')};">‚ñ∂ Start Game</div>
                        <div class="menu-item" style="background: ${p.backgroundAlt}; color: ${p.textPrimary};">‚öô Settings</div>
                        <div class="menu-item" style="background: ${p.backgroundAlt}; color: ${p.textPrimary};">üìä Leaderboard</div>
                        <div class="menu-item" style="background: ${p.errorBg}; color: ${p.errorText};">‚úï Exit</div>
                    </div>
                </div>
            `;
        }
        
        function renderGradientPreview() {
            const p = currentPalette;
            
            document.getElementById('gradientPreview').innerHTML = `
                <div style="padding: 20px; background: ${p.background}; color: ${p.textPrimary};">
                    <h4>–ì—Ä–∞–¥–∏–µ–Ω—Ç—ã</h4>
                    <div class="gradient-preview" style="background: linear-gradient(90deg, ${p.primary}, ${p.secondary});"></div>
                    <div class="gradient-preview" style="background: linear-gradient(135deg, ${p.primary}, ${p.accent});"></div>
                    <div class="gradient-preview" style="background: linear-gradient(90deg, ${p.success}, ${p.info});"></div>
                    <div class="gradient-preview" style="background: radial-gradient(circle, ${p.primary}, ${p.background});"></div>
                </div>
            `;
        }
        
        function exportPalette(format) {
            const p = currentPalette;
            let output = '';
            
            switch(format) {
                case 'css':
                    output = `/* ${currentMode} - ${currentScheme} */\n:root {\n`;
                    for (let [key, value] of Object.entries(p)) {
                        output += `  --${key.replace(/([A-Z])/g, '-$1').toLowerCase()}: ${value};\n`;
                    }
                    output += '}';
                    break;
                    
                case 'scss':
                    output = `// ${currentMode} - ${currentScheme}\n`;
                    for (let [key, value] of Object.entries(p)) {
                        output += `$${key.replace(/([A-Z])/g, '-$1').toLowerCase()}: ${value};\n`;
                    }
                    break;
                    
                case 'json':
                    output = JSON.stringify(p, null, 2);
                    break;
                    
                case 'tailwind':
                    output = `module.exports = {\n  theme: {\n    extend: {\n      colors: {\n`;
                    for (let [key, value] of Object.entries(p)) {
                        output += `        ${key}: '${value}',\n`;
                    }
                    output += '      }\n    }\n  }\n}';
                    break;
                    
                case 'unity':
                    output = `// Unity C# Color Palette\n`;
                    for (let [key, value] of Object.entries(p)) {
                        const rgb = hexToRgb(value);
                        output += `public static Color ${key} = new Color(${(rgb.r/255).toFixed(3)}f, ${(rgb.g/255).toFixed(3)}f, ${(rgb.b/255).toFixed(3)}f);\n`;
                    }
                    break;
                    
                case 'godot':
                    output = `# Godot Color Palette\n`;
                    for (let [key, value] of Object.entries(p)) {
                        output += `var ${key} = Color("${value}")\n`;
                    }
                    break;
                    
                case 'unreal':
                    output = `// Unreal Engine Color Palette\n`;
                    for (let [key, value] of Object.entries(p)) {
                        const rgb = hexToRgb(value);
                        output += `FLinearColor ${key}(${(rgb.r/255).toFixed(3)}f, ${(rgb.g/255).toFixed(3)}f, ${(rgb.b/255).toFixed(3)}f, 1.0f);\n`;
                    }
                    break;
            }
            
            navigator.clipboard.writeText(output);
            alert(`–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: ${format.toUpperCase()}`);
        }
        
        generateTheme('#007ACC');
        renderPresets();
    </script>
</body>
</html>